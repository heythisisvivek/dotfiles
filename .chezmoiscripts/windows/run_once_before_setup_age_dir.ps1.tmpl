# Define source and destination paths
$SOURCE_FILE = "$HOME\Chezmoi.key"
$DEST_DIR = "$HOME\.config\age"
$DEST_FILE = "$DEST_DIR\Chezmoi.key"

# Set error action preference
$ErrorActionPreference = "Stop"

try {
    # Check if source file exists
    if (Test-Path $SOURCE_FILE -PathType Leaf) {
        Write-Host "Chezmoi.key found in home directory"
        
        # Create destination directory if it doesn't exist
        if (!(Test-Path $DEST_DIR -PathType Container)) {
            New-Item -Path $DEST_DIR -ItemType Directory -Force | Out-Null
        }
        
        # Copy the file
        Copy-Item -Path $SOURCE_FILE -Destination $DEST_FILE -Force
        
        Write-Host "Successfully copied Chezmoi.key to $DEST_DIR\"
    }
    else {
        Write-Error "Error: Chezmoi.key not found in home directory"
        Write-Error "Expected location: $SOURCE_FILE"
        exit 1
    }
}
catch {
    Write-Error "Error: $($_.Exception.Message)"
    exit 1
}
